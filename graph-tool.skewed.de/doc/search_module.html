
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>graph_tool.search - Search algorithms &#8212; graph-tool 2.27 documentation</title>
    <link rel="stylesheet" href="https://graph-tool.skewed.de/static/doc/_static/gt_style.css" type="text/css" />
    <link rel="stylesheet" href="https://graph-tool.skewed.de/static/doc/_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="https://graph-tool.skewed.de/static/doc/_static/documentation_options.js"></script>
    <script type="text/javascript" src="https://graph-tool.skewed.de/static/doc/_static/jquery.js"></script>
    <script type="text/javascript" src="https://graph-tool.skewed.de/static/doc/_static/underscore.js"></script>
    <script type="text/javascript" src="https://graph-tool.skewed.de/static/doc/_static/doctools.js"></script>
    <script type="text/javascript" src="https://graph-tool.skewed.de/static/doc/_static/MathJax/MathJax.js?config=default"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within graph-tool 2.27 documentation"
          href="https://graph-tool.skewed.de/static/doc/_static/opensearch.xml"/>
    <link rel="shortcut icon" href="https://graph-tool.skewed.de/static/doc/_static/graph-icon.ico"/>
    <link rel="index" title="Index" href="https://graph-tool.skewed.de/static/doc/genindex.html" />
    <link rel="search" title="Search" href="https://graph-tool.skewed.de/static/doc/search.html" />
    <link rel="next" title="graph_tool.spectral - Spectral properties" href="spectral.html" />
    <link rel="prev" title="graph_tool.inference - Statistical inference of generative network models" href="community.html" />
    <script type="text/javascript">
      var _gaq = _gaq || [];
      var pluginUrl =
        '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
      _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
      _gaq.push(['_setAccount', 'UA-248813-2']);
      _gaq.push(['_setDomainName', '.skewed.de']);
      _gaq.push(['_trackPageview']);
      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
     

  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="https://graph-tool.skewed.de/static/doc/genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="https://graph-tool.skewed.de/static/doc/py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="spectral.html" title="graph_tool.spectral - Spectral properties"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="community.html" title="graph_tool.inference - Statistical inference of generative network models"
             accesskey="P">previous</a> |</li>
    <li><img src="../img/graph-icon.png" alt="logo" style="margin-right: 5px; margin-bottom:-2px;" /><a href="https://graph-tool.skewed.de/">Project Homepage</a> &raquo;</li>
    
        <li class="nav-item nav-item-0"><a href="../doc">graph-tool 2.27 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../static/doc/modules.html" >Module documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="https://graph-tool.skewed.de/static/doc/graph_tool.html" accesskey="U">graph_tool - efficient graph analysis and manipulation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-graph_tool.search"></span><div class="section" id="graph-tool-search-search-algorithms">
<h1><code class="docutils literal notranslate"><span class="pre">graph_tool.search</span></code> - Search algorithms<a class="headerlink" href="search_module.html#graph-tool-search-search-algorithms" title="Permalink to this headline">¶</a></h1>
<p>This module includes several search algorithms, which are customizable to
arbitrary purposes. It is mostly a wrapper around the Visitor interface of the
<a class="reference external" href="http://www.boost.org/doc/libs/release/libs/graph/doc/visitor_concepts.html">Boost Graph Library</a>,
and the respective search functions.</p>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="search_module.html#summary" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="search_module.html#graph_tool.search.bfs_search" title="graph_tool.search.bfs_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfs_search</span></code></a></td>
<td>Breadth-first traversal of a directed or undirected graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="search_module.html#graph_tool.search.bfs_iterator" title="graph_tool.search.bfs_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfs_iterator</span></code></a></td>
<td>Return an iterator of the edges corresponding to a breath-first traversal of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="search_module.html#graph_tool.search.dfs_search" title="graph_tool.search.dfs_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfs_search</span></code></a></td>
<td>Depth-first traversal of a directed or undirected graph.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="search_module.html#graph_tool.search.dfs_iterator" title="graph_tool.search.dfs_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfs_iterator</span></code></a></td>
<td>Return an iterator of the edges corresponding to a depth-first traversal of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_search" title="graph_tool.search.dijkstra_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dijkstra_search</span></code></a></td>
<td>Dijkstra traversal of a directed or undirected graph, with non-negative weights.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_iterator" title="graph_tool.search.dijkstra_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dijkstra_iterator</span></code></a></td>
<td>Return an iterator of the edges corresponding to a Dijkstra traversal of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="search_module.html#graph_tool.search.astar_search" title="graph_tool.search.astar_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astar_search</span></code></a></td>
<td>Heuristic <span class="math">\(A^*\)</span> search on a weighted, directed or undirected graph for the case where all edge weights are non-negative.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="search_module.html#graph_tool.search.astar_iterator" title="graph_tool.search.astar_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astar_iterator</span></code></a></td>
<td>Return an iterator of the edges corresponding to an <span class="math">\(A^*\)</span> traversal of the graph.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="search_module.html#graph_tool.search.bellman_ford_search" title="graph_tool.search.bellman_ford_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bellman_ford_search</span></code></a></td>
<td>Bellman-Ford traversal of a directed or undirected graph, with negative weights.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="search_module.html#graph_tool.search.BFSVisitor" title="graph_tool.search.BFSVisitor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BFSVisitor</span></code></a></td>
<td>A visitor object that is invoked at the event-points inside the <a class="reference internal" href="search_module.html#graph_tool.search.bfs_search" title="graph_tool.search.bfs_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">bfs_search()</span></code></a> algorithm.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="search_module.html#graph_tool.search.DFSVisitor" title="graph_tool.search.DFSVisitor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DFSVisitor</span></code></a></td>
<td>A visitor object that is invoked at the event-points inside the <a class="reference internal" href="search_module.html#graph_tool.search.dfs_search" title="graph_tool.search.dfs_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">dfs_search()</span></code></a> algorithm.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="search_module.html#graph_tool.search.DijkstraVisitor" title="graph_tool.search.DijkstraVisitor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DijkstraVisitor</span></code></a></td>
<td>A visitor object that is invoked at the event-points inside the <a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_search" title="graph_tool.search.dijkstra_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">dijkstra_search()</span></code></a> algorithm.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="search_module.html#graph_tool.search.BellmanFordVisitor" title="graph_tool.search.BellmanFordVisitor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BellmanFordVisitor</span></code></a></td>
<td>A visitor object that is invoked at the event-points inside the <a class="reference internal" href="search_module.html#graph_tool.search.bellman_ford_search" title="graph_tool.search.bellman_ford_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">bellman_ford_search()</span></code></a> algorithm.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="search_module.html#graph_tool.search.AStarVisitor" title="graph_tool.search.AStarVisitor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AStarVisitor</span></code></a></td>
<td>A visitor object that is invoked at the event-points inside the <a class="reference internal" href="search_module.html#graph_tool.search.astar_search" title="graph_tool.search.astar_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">astar_search()</span></code></a> algorithm.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="search_module.html#graph_tool.search.StopSearch" title="graph_tool.search.StopSearch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">StopSearch</span></code></a></td>
<td>If this exception is raised from inside any search visitor object, the search is aborted.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="search_module.html#examples" title="Permalink to this headline">¶</a></h2>
<p>In this module, most documentation examples will make use of the network
<a class="reference download internal" href="../static/doc/_downloads/search_example.xml" download=""><code class="xref download docutils literal notranslate"><span class="pre">search_example.xml</span></code></a>, shown below.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">load_graph</span><span class="p">(</span><span class="s2">&quot;search_example.xml&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">ep</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s2">&quot;pos&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">graph_draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">vertex_text</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">vertex_font_size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">vertex_shape</span><span class="o">=</span><span class="s2">&quot;double_circle&quot;</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">vertex_fill_color</span><span class="o">=</span><span class="s2">&quot;#729fcf&quot;</span><span class="p">,</span> <span class="n">vertex_pen_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">edge_pen_width</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;search_example.pdf&quot;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<div class="figure align-center" id="id27">
<img alt="search example" src="https://graph-tool.skewed.de/static/doc/_images/search_example.png" />
<p class="caption"><span class="caption-text">This is the network used in the examples below. The width of the edges
correspond to the values of the “weight” property map.</span></p>
</div>
</div>
<div class="section" id="contents">
<h2>Contents<a class="headerlink" href="search_module.html#contents" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="graph_tool.search.BFSVisitor">
<em class="property">class </em><code class="descclassname">graph_tool.search.</code><code class="descname">BFSVisitor</code><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BFSVisitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BFSVisitor" title="Permalink to this definition">¶</a></dt>
<dd><p>A visitor object that is invoked at the event-points inside the
<a class="reference internal" href="search_module.html#graph_tool.search.bfs_search" title="graph_tool.search.bfs_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">bfs_search()</span></code></a> algorithm. By default, it performs no
action, and should be used as a base class in order to be useful.</p>
<dl class="method">
<dt id="graph_tool.search.BFSVisitor.initialize_vertex">
<code class="descname">initialize_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BFSVisitor.initialize_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BFSVisitor.initialize_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on every vertex of the graph before the start of the
graph search.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BFSVisitor.discover_vertex">
<code class="descname">discover_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BFSVisitor.discover_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BFSVisitor.discover_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked when a vertex is encountered for the first time.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BFSVisitor.examine_vertex">
<code class="descname">examine_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BFSVisitor.examine_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BFSVisitor.examine_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on a vertex as it is popped from the queue. This
happens immediately before examine_edge() is invoked on each of the
out-edges of vertex u.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BFSVisitor.examine_edge">
<code class="descname">examine_edge</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BFSVisitor.examine_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BFSVisitor.examine_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on every out-edge of each vertex after it is
discovered.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BFSVisitor.tree_edge">
<code class="descname">tree_edge</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BFSVisitor.tree_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BFSVisitor.tree_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on each edge as it becomes a member of the edges that
form the search tree.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BFSVisitor.non_tree_edge">
<code class="descname">non_tree_edge</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BFSVisitor.non_tree_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BFSVisitor.non_tree_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on back or cross edges for directed graphs and cross
edges for undirected graphs.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BFSVisitor.gray_target">
<code class="descname">gray_target</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BFSVisitor.gray_target"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BFSVisitor.gray_target" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on the subset of non-tree edges whose target vertex
is colored gray at the time of examination. The color gray indicates
that the vertex is currently in the queue.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BFSVisitor.black_target">
<code class="descname">black_target</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BFSVisitor.black_target"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BFSVisitor.black_target" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on the subset of non-tree edges whose target vertex
is colored black at the time of examination. The color black indicates
that the vertex has been removed from the queue.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BFSVisitor.finish_vertex">
<code class="descname">finish_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BFSVisitor.finish_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BFSVisitor.finish_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This invoked on a vertex after all of its out edges have been added
to the search tree and all of the adjacent vertices have been discovered
(but before the out-edges of the adjacent vertices have been examined).</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="graph_tool.search.bfs_search">
<code class="descclassname">graph_tool.search.</code><code class="descname">bfs_search</code><span class="sig-paren">(</span><em>g</em>, <em>source=None</em>, <em>visitor=&lt;graph_tool.search.BFSVisitor object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#bfs_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.bfs_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Breadth-first traversal of a directed or undirected graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Graph" title="graph_tool.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></p>
<blockquote>
<div><p>Graph to be used.</p>
</div></blockquote>
<p><strong>source</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>Source vertex. If unspecified, all vertices will be traversed, by
iterating over starting vertices according to their index in increasing
order.</p>
</div></blockquote>
<p><strong>visitor</strong> : <a class="reference internal" href="search_module.html#graph_tool.search.BFSVisitor" title="graph_tool.search.BFSVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BFSVisitor</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">BFSVisitor()</span></code>)</p>
<blockquote class="last">
<div><p>A visitor object that is invoked at the event points inside the
algorithm. This should be a subclass of
<a class="reference internal" href="search_module.html#graph_tool.search.BFSVisitor" title="graph_tool.search.BFSVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BFSVisitor</span></code></a>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dfs_search" title="graph_tool.search.dfs_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfs_search</span></code></a></dt>
<dd>Depth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_search" title="graph_tool.search.dijkstra_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dijkstra_search</span></code></a></dt>
<dd>Dijkstra’s search algorithm</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.astar_search" title="graph_tool.search.astar_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astar_search</span></code></a></dt>
<dd><span class="math">\(A^*\)</span> heuristic search algorithm</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>A breadth-first traversal visits vertices that are closer to the source
before visiting vertices that are further away. In this context “distance”
is defined as the number of edges in the shortest path from the source
vertex.</p>
<p>The time complexity is <span class="math">\(O(V + E)\)</span>.</p>
<p>The pseudo-code for the BFS algorithm is listed below, with the annotated
event points, for which the given visitor object will be called with the
appropriate method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BFS</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>
 <span class="k">for</span> <span class="n">each</span> <span class="n">vertex</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">V</span><span class="p">[</span><span class="n">G</span><span class="p">]</span>       <span class="n">initialize</span> <span class="n">vertex</span> <span class="n">u</span>
   <span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">WHITE</span>
   <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">infinity</span>
 <span class="n">end</span> <span class="k">for</span>
 <span class="n">color</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">GRAY</span>
 <span class="n">d</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="mi">0</span>
 <span class="n">ENQUEUE</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>              <span class="n">discover</span> <span class="n">vertex</span> <span class="n">source</span>
 <span class="k">while</span> <span class="p">(</span><span class="n">Q</span> <span class="o">!=</span> <span class="n">Ø</span><span class="p">)</span>
   <span class="n">u</span> <span class="p">:</span><span class="o">=</span> <span class="n">DEQUEUE</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>               <span class="n">examine</span> <span class="n">vertex</span> <span class="n">u</span>
   <span class="k">for</span> <span class="n">each</span> <span class="n">vertex</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">Adj</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>   <span class="n">examine</span> <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
     <span class="k">if</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">WHITE</span><span class="p">)</span>       <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">tree</span> <span class="n">edge</span>
       <span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">GRAY</span>
       <span class="n">ENQUEUE</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>             <span class="n">discover</span> <span class="n">vertex</span> <span class="n">v</span>
     <span class="k">else</span>                        <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">non</span><span class="o">-</span><span class="n">tree</span> <span class="n">edge</span>
       <span class="k">if</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">GRAY</span><span class="p">)</span>
         <span class="o">...</span>                     <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="n">has</span> <span class="n">a</span> <span class="n">gray</span> <span class="n">target</span>
       <span class="k">else</span>
         <span class="o">...</span>                     <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="n">has</span> <span class="n">a</span> <span class="n">black</span> <span class="n">target</span>
   <span class="n">end</span> <span class="k">for</span>
   <span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">BLACK</span>             <span class="n">finish</span> <span class="n">vertex</span> <span class="n">u</span>
 <span class="n">end</span> <span class="k">while</span>
</pre></div>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="bfs212" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id1">[bfs212]</a></td><td>Edward Moore, “The shortest path through a maze”, International
Symposium on the Theory of Switching, 1959</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bfs-bgl212" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id2">[bfs-bgl212]</a></td><td><a class="reference external" href="http://www.boost.org/doc/libs/release/libs/graph/doc/breadth_first_search.html">http://www.boost.org/doc/libs/release/libs/graph/doc/breadth_first_search.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bfs-wikipedia212" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id3">[bfs-wikipedia212]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Breadth-first_search">http://en.wikipedia.org/wiki/Breadth-first_search</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>We must define what should be done during the search by subclassing
<a class="reference internal" href="search_module.html#graph_tool.search.BFSVisitor" title="graph_tool.search.BFSVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BFSVisitor</span></code></a>, and specializing the appropriate
methods. In the following we will keep track of the distance from the root,
and the predecessor tree.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">VisitorExample</span><span class="p">(</span><span class="n">gt</span><span class="o">.</span><span class="n">BFSVisitor</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">dist</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span>

    <span class="k">def</span> <span class="nf">discover_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;--&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="s2">&quot;has been discovered!&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">examine_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="s2">&quot;has been examined...&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tree_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pred</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()]</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>With the above class defined, we can perform the BFS search as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">&quot;int64_t&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">bfs_search</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">VisitorExample</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">dist</span><span class="p">))</span>
<span class="go">--&gt; Bob has been discovered!</span>
<span class="go">Bob has been examined...</span>
<span class="go">--&gt; Eve has been discovered!</span>
<span class="go">--&gt; Chuck has been discovered!</span>
<span class="go">--&gt; Carlos has been discovered!</span>
<span class="go">--&gt; Isaac has been discovered!</span>
<span class="go">Eve has been examined...</span>
<span class="go">--&gt; Imothep has been discovered!</span>
<span class="go">--&gt; Carol has been discovered!</span>
<span class="go">Chuck has been examined...</span>
<span class="go">Carlos has been examined...</span>
<span class="go">--&gt; Alice has been discovered!</span>
<span class="go">Isaac has been examined...</span>
<span class="go">Imothep has been examined...</span>
<span class="go">Carol has been examined...</span>
<span class="go">Alice has been examined...</span>
<span class="go">--&gt; Oscar has been discovered!</span>
<span class="go">--&gt; Dave has been discovered!</span>
<span class="go">Oscar has been examined...</span>
<span class="go">Dave has been examined...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="go">[0 2 2 1 1 3 1 1 3 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="go">[0 3 6 0 0 1 0 0 1 6]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="graph_tool.search.bfs_iterator">
<code class="descclassname">graph_tool.search.</code><code class="descname">bfs_iterator</code><span class="sig-paren">(</span><em>g</em>, <em>source=None</em>, <em>array=False</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#bfs_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.bfs_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator of the edges corresponding to a breath-first traversal of
the graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Graph" title="graph_tool.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></p>
<blockquote>
<div><p>Graph to be used.</p>
</div></blockquote>
<p><strong>source</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>Source vertex. If unspecified, all vertices will be traversed, by
iterating over starting vertices according to their index in increasing
order.</p>
</div></blockquote>
<p><strong>array</strong> : <code class="docutils literal notranslate"><span class="pre">bool</span></code> (optional, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> will the edge endpoints be
returned instead.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>bfs_iterator</strong> : Iterator or <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
<blockquote class="last">
<div><p>An iterator over the edges in breath-first order. If <code class="docutils literal notranslate"><span class="pre">array</span> <span class="pre">==</span> <span class="pre">True</span></code>,
this will be a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> instead, of shape <code class="docutils literal notranslate"><span class="pre">(E,2)</span></code>,
containing the edge endpoints.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dfs_iterator" title="graph_tool.search.dfs_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfs_iterator</span></code></a></dt>
<dd>Depth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_iterator" title="graph_tool.search.dijkstra_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dijkstra_iterator</span></code></a></dt>
<dd>Dijkstra’s search algorithm</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.astar_iterator" title="graph_tool.search.astar_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astar_iterator</span></code></a></dt>
<dd><span class="math">\(A^*\)</span> heuristic search algorithm</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>See <a class="reference internal" href="search_module.html#graph_tool.search.bfs_search" title="graph_tool.search.bfs_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">bfs_search()</span></code></a> for an explanation of the
algorithm.</p>
<p>The time complexity is <span class="math">\(O(1)\)</span> to create the generator and
<span class="math">\(O(V + E)\)</span> to traverse it completely.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="bfs215" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id4">[bfs215]</a></td><td>Edward Moore, “The shortest path through a maze”, International
Symposium on the Theory of Switching, 1959</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bfs-bgl215" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id5">[bfs-bgl215]</a></td><td><a class="reference external" href="http://www.boost.org/doc/libs/release/libs/graph/doc/breadth_first_search.html">http://www.boost.org/doc/libs/release/libs/graph/doc/breadth_first_search.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bfs-wikipedia215" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id6">[bfs-wikipedia215]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Breadth-first_search">http://en.wikipedia.org/wiki/Breadth-first_search</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">gt</span><span class="o">.</span><span class="n">bfs_iterator</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()],</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()])</span>
<span class="go">Bob -&gt; Eve</span>
<span class="go">Bob -&gt; Chuck</span>
<span class="go">Bob -&gt; Carlos</span>
<span class="go">Bob -&gt; Isaac</span>
<span class="go">Eve -&gt; Imothep</span>
<span class="go">Eve -&gt; Carol</span>
<span class="go">Carlos -&gt; Alice</span>
<span class="go">Alice -&gt; Oscar</span>
<span class="go">Alice -&gt; Dave</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="graph_tool.search.DFSVisitor">
<em class="property">class </em><code class="descclassname">graph_tool.search.</code><code class="descname">DFSVisitor</code><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DFSVisitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DFSVisitor" title="Permalink to this definition">¶</a></dt>
<dd><p>A visitor object that is invoked at the event-points inside the
<a class="reference internal" href="search_module.html#graph_tool.search.dfs_search" title="graph_tool.search.dfs_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">dfs_search()</span></code></a> algorithm. By default, it performs no
action, and should be used as a base class in order to be useful.</p>
<dl class="method">
<dt id="graph_tool.search.DFSVisitor.initialize_vertex">
<code class="descname">initialize_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DFSVisitor.initialize_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DFSVisitor.initialize_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on every vertex of the graph before the start of the
graph search.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DFSVisitor.start_vertex">
<code class="descname">start_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DFSVisitor.start_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DFSVisitor.start_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on the source vertex once before the start of the
search.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DFSVisitor.discover_vertex">
<code class="descname">discover_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DFSVisitor.discover_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DFSVisitor.discover_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked when a vertex is encountered for the first time.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DFSVisitor.examine_edge">
<code class="descname">examine_edge</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DFSVisitor.examine_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DFSVisitor.examine_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on every out-edge of each vertex after it is discovered.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DFSVisitor.tree_edge">
<code class="descname">tree_edge</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DFSVisitor.tree_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DFSVisitor.tree_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on each edge as it becomes a member of the edges that
form the search tree.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DFSVisitor.back_edge">
<code class="descname">back_edge</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DFSVisitor.back_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DFSVisitor.back_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on the back edges in the graph. For an undirected graph
there is some ambiguity between tree edges and back edges since the edge
(u,v) and (v,u) are the same edge, but both the
<a class="reference internal" href="search_module.html#graph_tool.search.DFSVisitor.tree_edge" title="graph_tool.search.DFSVisitor.tree_edge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tree_edge()</span></code></a> and
<a class="reference internal" href="search_module.html#graph_tool.search.DFSVisitor.back_edge" title="graph_tool.search.DFSVisitor.back_edge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">back_edge()</span></code></a> functions will be
invoked. One way to resolve this ambiguity is to record the tree edges,
and then disregard the back-edges that are already marked as tree
edges. An easy way to record tree edges is to record predecessors at the
tree_edge event point.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DFSVisitor.forward_or_cross_edge">
<code class="descname">forward_or_cross_edge</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DFSVisitor.forward_or_cross_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DFSVisitor.forward_or_cross_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on forward or cross edges in the graph. In an undirected
graph this method is never called.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DFSVisitor.finish_vertex">
<code class="descname">finish_vertex</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DFSVisitor.finish_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DFSVisitor.finish_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on vertex u after finish_vertex has been called for all
the vertices in the DFS-tree rooted at vertex u. If vertex u is a leaf
in the DFS-tree, then the
<a class="reference internal" href="search_module.html#graph_tool.search.DFSVisitor.finish_vertex" title="graph_tool.search.DFSVisitor.finish_vertex"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finish_vertex()</span></code></a> function is called
on u after all the out-edges of u have been examined.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="graph_tool.search.dfs_search">
<code class="descclassname">graph_tool.search.</code><code class="descname">dfs_search</code><span class="sig-paren">(</span><em>g</em>, <em>source=None</em>, <em>visitor=&lt;graph_tool.search.DFSVisitor object&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#dfs_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.dfs_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Depth-first traversal of a directed or undirected graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Graph" title="graph_tool.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></p>
<blockquote>
<div><p>Graph to be used.</p>
</div></blockquote>
<p><strong>source</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>Source vertex. If unspecified, all vertices will be traversed, by
iterating over starting vertices according to their index in increasing
order.</p>
</div></blockquote>
<p><strong>visitor</strong> : <a class="reference internal" href="search_module.html#graph_tool.search.DFSVisitor" title="graph_tool.search.DFSVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DFSVisitor</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">DFSVisitor()</span></code>)</p>
<blockquote class="last">
<div><p>A visitor object that is invoked at the event points inside the
algorithm. This should be a subclass of
<a class="reference internal" href="search_module.html#graph_tool.search.DFSVisitor" title="graph_tool.search.DFSVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DFSVisitor</span></code></a>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="search_module.html#graph_tool.search.bfs_search" title="graph_tool.search.bfs_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfs_search</span></code></a></dt>
<dd>Breadth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_search" title="graph_tool.search.dijkstra_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dijkstra_search</span></code></a></dt>
<dd>Dijkstra’s search algorithm</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.astar_search" title="graph_tool.search.astar_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astar_search</span></code></a></dt>
<dd><span class="math">\(A^*\)</span> heuristic search algorithm</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>When possible, a depth-first traversal chooses a vertex adjacent to the
current vertex to visit next. If all adjacent vertices have already been
discovered, or there are no adjacent vertices, then the algorithm backtracks
to the last vertex that had undiscovered neighbors. Once all reachable
vertices have been visited, the algorithm selects from any remaining
undiscovered vertices and continues the traversal. The algorithm finishes
when all vertices have been visited.</p>
<p>The time complexity is <span class="math">\(O(V + E)\)</span>.</p>
<p>The pseudo-code for the DFS algorithm is listed below, with the annotated
event points, for which the given visitor object will be called with the
appropriate method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DFS</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">each</span> <span class="n">vertex</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">V</span>
    <span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">WHITE</span>                 <span class="n">initialize</span> <span class="n">vertex</span> <span class="n">u</span>
  <span class="n">end</span> <span class="k">for</span>
  <span class="n">time</span> <span class="p">:</span><span class="o">=</span> <span class="mi">0</span>
  <span class="n">call</span> <span class="n">DFS</span><span class="o">-</span><span class="n">VISIT</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>           <span class="n">start</span> <span class="n">vertex</span> <span class="n">s</span>

<span class="n">DFS</span><span class="o">-</span><span class="n">VISIT</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span>
  <span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">GRAY</span>                    <span class="n">discover</span> <span class="n">vertex</span> <span class="n">u</span>
  <span class="k">for</span> <span class="n">each</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">Adj</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>                <span class="n">examine</span> <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">WHITE</span><span class="p">)</span>             <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">tree</span> <span class="n">edge</span>
      <span class="n">call</span> <span class="n">DFS</span><span class="o">-</span><span class="n">VISIT</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">GRAY</span><span class="p">)</span>         <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">back</span> <span class="n">edge</span>
      <span class="o">...</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">BLACK</span><span class="p">)</span>        <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">cross</span> <span class="ow">or</span> <span class="n">forward</span> <span class="n">edge</span>
      <span class="o">...</span>
  <span class="n">end</span> <span class="k">for</span>
  <span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">BLACK</span>                   <span class="n">finish</span> <span class="n">vertex</span> <span class="n">u</span>
</pre></div>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="dfs-bgl218" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id7">[dfs-bgl218]</a></td><td><a class="reference external" href="http://www.boost.org/doc/libs/release/libs/graph/doc/depth_first_search.html">http://www.boost.org/doc/libs/release/libs/graph/doc/depth_first_search.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="dfs-wikipedia218" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id8">[dfs-wikipedia218]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Depth-first_search">http://en.wikipedia.org/wiki/Depth-first_search</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>We must define what should be done during the search by subclassing
<a class="reference internal" href="search_module.html#graph_tool.search.DFSVisitor" title="graph_tool.search.DFSVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DFSVisitor</span></code></a>, and specializing the appropriate
methods. In the following we will keep track of the discover time, and the
predecessor tree.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">VisitorExample</span><span class="p">(</span><span class="n">gt</span><span class="o">.</span><span class="n">DFSVisitor</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pred</span> <span class="o">=</span> <span class="n">pred</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_time</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">discover_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;--&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="s2">&quot;has been discovered!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_time</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">examine_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;edge (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">) has been examined...&quot;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]))</span>

    <span class="k">def</span> <span class="nf">tree_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pred</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">())</span>
</pre></div>
</div>
<p>With the above class defined, we can perform the DFS search as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">&quot;int64_t&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">dfs_search</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">VisitorExample</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">pred</span><span class="p">,</span> <span class="n">time</span><span class="p">))</span>
<span class="go">--&gt; Bob has been discovered!</span>
<span class="go">edge (Bob, Eve) has been examined...</span>
<span class="go">--&gt; Eve has been discovered!</span>
<span class="go">edge (Eve, Isaac) has been examined...</span>
<span class="go">--&gt; Isaac has been discovered!</span>
<span class="go">edge (Isaac, Bob) has been examined...</span>
<span class="go">edge (Isaac, Chuck) has been examined...</span>
<span class="go">--&gt; Chuck has been discovered!</span>
<span class="go">edge (Chuck, Eve) has been examined...</span>
<span class="go">edge (Chuck, Isaac) has been examined...</span>
<span class="go">edge (Chuck, Imothep) has been examined...</span>
<span class="go">--&gt; Imothep has been discovered!</span>
<span class="go">edge (Imothep, Carol) has been examined...</span>
<span class="go">--&gt; Carol has been discovered!</span>
<span class="go">edge (Carol, Eve) has been examined...</span>
<span class="go">edge (Carol, Imothep) has been examined...</span>
<span class="go">edge (Imothep, Carlos) has been examined...</span>
<span class="go">--&gt; Carlos has been discovered!</span>
<span class="go">edge (Carlos, Eve) has been examined...</span>
<span class="go">edge (Carlos, Imothep) has been examined...</span>
<span class="go">edge (Carlos, Bob) has been examined...</span>
<span class="go">edge (Carlos, Alice) has been examined...</span>
<span class="go">--&gt; Alice has been discovered!</span>
<span class="go">edge (Alice, Oscar) has been examined...</span>
<span class="go">--&gt; Oscar has been discovered!</span>
<span class="go">edge (Oscar, Alice) has been examined...</span>
<span class="go">edge (Oscar, Dave) has been examined...</span>
<span class="go">--&gt; Dave has been discovered!</span>
<span class="go">edge (Dave, Oscar) has been examined...</span>
<span class="go">edge (Dave, Alice) has been examined...</span>
<span class="go">edge (Alice, Dave) has been examined...</span>
<span class="go">edge (Alice, Carlos) has been examined...</span>
<span class="go">edge (Imothep, Chuck) has been examined...</span>
<span class="go">edge (Imothep, Eve) has been examined...</span>
<span class="go">edge (Chuck, Bob) has been examined...</span>
<span class="go">edge (Isaac, Eve) has been examined...</span>
<span class="go">edge (Eve, Imothep) has been examined...</span>
<span class="go">edge (Eve, Carlos) has been examined...</span>
<span class="go">edge (Eve, Chuck) has been examined...</span>
<span class="go">edge (Eve, Bob) has been examined...</span>
<span class="go">edge (Eve, Carol) has been examined...</span>
<span class="go">edge (Bob, Chuck) has been examined...</span>
<span class="go">edge (Bob, Carlos) has been examined...</span>
<span class="go">edge (Bob, Isaac) has been examined...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="go">[0 7 5 6 3 9 1 2 8 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="go">[0 3 9 9 7 8 0 6 1 4]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="graph_tool.search.dfs_iterator">
<code class="descclassname">graph_tool.search.</code><code class="descname">dfs_iterator</code><span class="sig-paren">(</span><em>g</em>, <em>source=None</em>, <em>array=False</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#dfs_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.dfs_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator of the edges corresponding to a depth-first traversal of
the graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Graph" title="graph_tool.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></p>
<blockquote>
<div><p>Graph to be used.</p>
</div></blockquote>
<p><strong>source</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>Source vertex. If unspecified, all vertices will be traversed, by
iterating over starting vertices according to their index in increasing
order.</p>
</div></blockquote>
<p><strong>array</strong> : <code class="docutils literal notranslate"><span class="pre">bool</span></code> (optional, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> will the edge endpoints be
returned instead.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dfs_iterator</strong> : Iterator or <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
<blockquote class="last">
<div><p>An iterator over the edges in depth-first order. If <code class="docutils literal notranslate"><span class="pre">array</span> <span class="pre">==</span> <span class="pre">True</span></code>,
this will be a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> instead, of shape <code class="docutils literal notranslate"><span class="pre">(E,2)</span></code>,
containing the edge endpoints.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="search_module.html#graph_tool.search.bfs_iterator" title="graph_tool.search.bfs_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfs_iterator</span></code></a></dt>
<dd>Breadth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_iterator" title="graph_tool.search.dijkstra_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dijkstra_iterator</span></code></a></dt>
<dd>Dijkstra’s search algorithm</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.astar_iterator" title="graph_tool.search.astar_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astar_iterator</span></code></a></dt>
<dd><span class="math">\(A^*\)</span> heuristic search algorithm</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>See <a class="reference internal" href="search_module.html#graph_tool.search.dfs_search" title="graph_tool.search.dfs_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">dfs_search()</span></code></a> for an explanation of the
algorithm.</p>
<p>The time complexity is <span class="math">\(O(1)\)</span> to create the generator and
<span class="math">\(O(V + E)\)</span> to traverse it completely.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="dfs-bgl220" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id9">[dfs-bgl220]</a></td><td><a class="reference external" href="http://www.boost.org/doc/libs/release/libs/graph/doc/depth_first_search.html">http://www.boost.org/doc/libs/release/libs/graph/doc/depth_first_search.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="dfs-wikipedia220" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id10">[dfs-wikipedia220]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Depth-first_search">http://en.wikipedia.org/wiki/Depth-first_search</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">gt</span><span class="o">.</span><span class="n">dfs_iterator</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()],</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()])</span>
<span class="go">Bob -&gt; Eve</span>
<span class="go">Eve -&gt; Isaac</span>
<span class="go">Isaac -&gt; Chuck</span>
<span class="go">Chuck -&gt; Imothep</span>
<span class="go">Imothep -&gt; Carol</span>
<span class="go">Imothep -&gt; Carlos</span>
<span class="go">Carlos -&gt; Alice</span>
<span class="go">Alice -&gt; Oscar</span>
<span class="go">Oscar -&gt; Dave</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="graph_tool.search.DijkstraVisitor">
<em class="property">class </em><code class="descclassname">graph_tool.search.</code><code class="descname">DijkstraVisitor</code><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DijkstraVisitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DijkstraVisitor" title="Permalink to this definition">¶</a></dt>
<dd><p>A visitor object that is invoked at the event-points inside the
<a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_search" title="graph_tool.search.dijkstra_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">dijkstra_search()</span></code></a> algorithm. By default, it
performs no action, and should be used as a base class in order to be
useful.</p>
<dl class="method">
<dt id="graph_tool.search.DijkstraVisitor.initialize_vertex">
<code class="descname">initialize_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DijkstraVisitor.initialize_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DijkstraVisitor.initialize_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on every vertex of the graph before the start of the
graph search.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DijkstraVisitor.examine_vertex">
<code class="descname">examine_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DijkstraVisitor.examine_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DijkstraVisitor.examine_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on a vertex as it is popped from the queue. This happens
immediately before
<a class="reference internal" href="search_module.html#graph_tool.search.DijkstraVisitor.examine_edge" title="graph_tool.search.DijkstraVisitor.examine_edge"><code class="xref py py-meth docutils literal notranslate"><span class="pre">examine_edge()</span></code></a> is invoked on
each of the out-edges of vertex u.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DijkstraVisitor.examine_edge">
<code class="descname">examine_edge</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DijkstraVisitor.examine_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DijkstraVisitor.examine_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on every out-edge of each vertex after it is discovered.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DijkstraVisitor.discover_vertex">
<code class="descname">discover_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DijkstraVisitor.discover_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DijkstraVisitor.discover_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked when a vertex is encountered for the first time.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DijkstraVisitor.edge_relaxed">
<code class="descname">edge_relaxed</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DijkstraVisitor.edge_relaxed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DijkstraVisitor.edge_relaxed" title="Permalink to this definition">¶</a></dt>
<dd><p>Upon examination, if the following condition holds then the edge is
relaxed (its distance is reduced), and this method is invoked.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="k">assert</span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">combine</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">weight</span><span class="p">[</span><span class="n">e</span><span class="p">]),</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DijkstraVisitor.edge_not_relaxed">
<code class="descname">edge_not_relaxed</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DijkstraVisitor.edge_not_relaxed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DijkstraVisitor.edge_not_relaxed" title="Permalink to this definition">¶</a></dt>
<dd><p>Upon examination, if the edge is not relaxed (see
<a class="reference internal" href="search_module.html#graph_tool.search.DijkstraVisitor.edge_relaxed" title="graph_tool.search.DijkstraVisitor.edge_relaxed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">edge_relaxed()</span></code></a>) then this
method is invoked.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.DijkstraVisitor.finish_vertex">
<code class="descname">finish_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#DijkstraVisitor.finish_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.DijkstraVisitor.finish_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This invoked on a vertex after all of its out edges have been added to
the search tree and all of the adjacent vertices have been discovered
(but before their out-edges have been examined).</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="graph_tool.search.dijkstra_search">
<code class="descclassname">graph_tool.search.</code><code class="descname">dijkstra_search</code><span class="sig-paren">(</span><em>g</em>, <em>weight</em>, <em>source=None</em>, <em>visitor=&lt;graph_tool.search.DijkstraVisitor object&gt;</em>, <em>dist_map=None</em>, <em>pred_map=None</em>, <em>combine=&lt;function &lt;lambda&gt;&gt;</em>, <em>compare=&lt;function &lt;lambda&gt;&gt;</em>, <em>zero=0</em>, <em>infinity=inf</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#dijkstra_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.dijkstra_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Dijkstra traversal of a directed or undirected graph, with non-negative weights.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Graph" title="graph_tool.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></p>
<blockquote>
<div><p>Graph to be used.</p>
</div></blockquote>
<p><strong>weight</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote>
<div><p>Edge property map with weight values.</p>
</div></blockquote>
<p><strong>source</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>Source vertex. If unspecified, all vertices will be traversed, by
iterating over starting vertices according to their index in increasing
order.</p>
</div></blockquote>
<p><strong>visitor</strong> : <a class="reference internal" href="search_module.html#graph_tool.search.DijkstraVisitor" title="graph_tool.search.DijkstraVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DijkstraVisitor</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">DijkstraVisitor()</span></code>)</p>
<blockquote>
<div><p>A visitor object that is invoked at the event points inside the
algorithm. This should be a subclass of
<a class="reference internal" href="search_module.html#graph_tool.search.DijkstraVisitor" title="graph_tool.search.DijkstraVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DijkstraVisitor</span></code></a>.</p>
</div></blockquote>
<p><strong>dist_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>A vertex property map where the distances from the source will be
stored.</p>
</div></blockquote>
<p><strong>pred_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>A vertex property map where the predecessor map will be
stored (must have value type “int64_t”).</p>
</div></blockquote>
<p><strong>combine</strong> : binary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code>)</p>
<blockquote>
<div><p>This function is used to combine distances to compute the distance of a
path.</p>
</div></blockquote>
<p><strong>compare</strong> : binary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code>)</p>
<blockquote>
<div><p>This function is use to compare distances to determine which vertex is
closer to the source vertex.</p>
</div></blockquote>
<p><strong>zero</strong> : int or float (optional, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p>
<blockquote>
<div><p>Value assumed to correspond to a distance of zero by the combine and
compare functions.</p>
</div></blockquote>
<p><strong>infinity</strong> : int or float (optional, default: <code class="docutils literal notranslate"><span class="pre">numpy.inf</span></code>)</p>
<blockquote>
<div><p>Value assumed to correspond to a distance of infinity by the combine and
compare functions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dist_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote>
<div><p>A vertex property map with the computed distances from the source.</p>
</div></blockquote>
<p><strong>pred_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote class="last">
<div><p>A vertex property map with the predecessor tree.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="search_module.html#graph_tool.search.bfs_search" title="graph_tool.search.bfs_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfs_search</span></code></a></dt>
<dd>Breadth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dfs_search" title="graph_tool.search.dfs_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfs_search</span></code></a></dt>
<dd>Depth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.astar_search" title="graph_tool.search.astar_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astar_search</span></code></a></dt>
<dd><span class="math">\(A^*\)</span> heuristic search algorithm</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Dijkstra’s algorithm finds all the shortest paths from the source vertex to
every other vertex by iteratively “growing” the set of vertices S to which
it knows the shortest path. At each step of the algorithm, the next vertex
added to S is determined by a priority queue. The queue contains the
vertices in V - S prioritized by their distance label, which is the length
of the shortest path seen so far for each vertex. The vertex u at the top of
the priority queue is then added to S, and each of its out-edges is relaxed:
if the distance to u plus the weight of the out-edge (u,v) is less than the
distance label for v then the estimated distance for vertex v is
reduced. The algorithm then loops back, processing the next vertex at the
top of the priority queue. The algorithm finishes when the priority queue is
empty.</p>
<p>The time complexity is <span class="math">\(O(E + V \log V)\)</span>.</p>
<p>The pseudo-code for Dijkstra’s algorithm is listed below, with the annotated
event points, for which the given visitor object will be called with the
appropriate method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DIJKSTRA</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">weight</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">each</span> <span class="n">vertex</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">V</span>                      <span class="n">initialize</span> <span class="n">vertex</span> <span class="n">u</span>
    <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">infinity</span>
    <span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">u</span>
  <span class="n">end</span> <span class="k">for</span>
  <span class="n">d</span><span class="p">[</span><span class="n">source</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="mi">0</span>
  <span class="n">INSERT</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>                           <span class="n">discover</span> <span class="n">vertex</span> <span class="n">s</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">Q</span> <span class="o">!=</span> <span class="n">Ø</span><span class="p">)</span>
    <span class="n">u</span> <span class="p">:</span><span class="o">=</span> <span class="n">EXTRACT</span><span class="o">-</span><span class="n">MIN</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>                       <span class="n">examine</span> <span class="n">vertex</span> <span class="n">u</span>
    <span class="k">for</span> <span class="n">each</span> <span class="n">vertex</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">Adj</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>               <span class="n">examine</span> <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">weight</span><span class="p">[(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>        <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="n">relaxed</span>
        <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">weight</span><span class="p">[(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)]</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>
        <span class="n">p</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">u</span>
        <span class="n">DECREASE</span><span class="o">-</span><span class="n">KEY</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
      <span class="k">else</span>                                    <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">not</span> <span class="n">relaxed</span>
        <span class="o">...</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="n">was</span> <span class="n">originally</span> <span class="n">infinity</span><span class="p">)</span>
        <span class="n">INSERT</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>                          <span class="n">discover</span> <span class="n">vertex</span> <span class="n">v</span>
    <span class="n">end</span> <span class="k">for</span>                                   <span class="n">finish</span> <span class="n">vertex</span> <span class="n">u</span>
  <span class="n">end</span> <span class="k">while</span>
  <span class="k">return</span> <span class="n">d</span>
</pre></div>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="dijkstra222" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id11">[dijkstra222]</a></td><td>E. Dijkstra, “A note on two problems in connexion with
graphs”, Numerische Mathematik, 1:269-271, 1959.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="dijkstra-bgl222" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id12">[dijkstra-bgl222]</a></td><td><a class="reference external" href="http://www.boost.org/doc/libs/release/libs/graph/doc/dijkstra_shortest_paths_no_color_map.html">http://www.boost.org/doc/libs/release/libs/graph/doc/dijkstra_shortest_paths_no_color_map.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="dijkstra-wikipedia222" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id13">[dijkstra-wikipedia222]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Dijkstra's_algorithm">http://en.wikipedia.org/wiki/Dijkstra’s_algorithm</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>We must define what should be done during the search by subclassing
<a class="reference internal" href="search_module.html#graph_tool.search.DijkstraVisitor" title="graph_tool.search.DijkstraVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DijkstraVisitor</span></code></a>, and specializing the
appropriate methods. In the following we will keep track of the discover
time, and the predecessor tree.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">VisitorExample</span><span class="p">(</span><span class="n">gt</span><span class="o">.</span><span class="n">DijkstraVisitor</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span> <span class="o">=</span> <span class="n">time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_time</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">discover_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;--&gt;&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="s2">&quot;has been discovered!&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">last_time</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">last_time</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">def</span> <span class="nf">examine_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;edge (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">) has been examined...&quot;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]))</span>

    <span class="k">def</span> <span class="nf">edge_relaxed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;edge (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">) has been relaxed...&quot;</span> <span class="o">%</span> \
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]))</span>
</pre></div>
</div>
<p>With the above class defined, we can perform the Dijkstra search as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">time</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">&quot;int&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">dijkstra_search</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">VisitorExample</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">time</span><span class="p">))</span>
<span class="go">--&gt; Bob has been discovered!</span>
<span class="go">edge (Bob, Eve) has been examined...</span>
<span class="go">edge (Bob, Eve) has been relaxed...</span>
<span class="go">--&gt; Eve has been discovered!</span>
<span class="go">edge (Bob, Chuck) has been examined...</span>
<span class="go">edge (Bob, Chuck) has been relaxed...</span>
<span class="go">--&gt; Chuck has been discovered!</span>
<span class="go">edge (Bob, Carlos) has been examined...</span>
<span class="go">edge (Bob, Carlos) has been relaxed...</span>
<span class="go">--&gt; Carlos has been discovered!</span>
<span class="go">edge (Bob, Isaac) has been examined...</span>
<span class="go">edge (Bob, Isaac) has been relaxed...</span>
<span class="go">--&gt; Isaac has been discovered!</span>
<span class="go">edge (Eve, Isaac) has been examined...</span>
<span class="go">edge (Eve, Imothep) has been examined...</span>
<span class="go">edge (Eve, Imothep) has been relaxed...</span>
<span class="go">--&gt; Imothep has been discovered!</span>
<span class="go">edge (Eve, Carlos) has been examined...</span>
<span class="go">edge (Eve, Chuck) has been examined...</span>
<span class="go">edge (Eve, Bob) has been examined...</span>
<span class="go">edge (Eve, Carol) has been examined...</span>
<span class="go">edge (Eve, Carol) has been relaxed...</span>
<span class="go">--&gt; Carol has been discovered!</span>
<span class="go">edge (Isaac, Bob) has been examined...</span>
<span class="go">edge (Isaac, Chuck) has been examined...</span>
<span class="go">edge (Isaac, Eve) has been examined...</span>
<span class="go">edge (Chuck, Eve) has been examined...</span>
<span class="go">edge (Chuck, Isaac) has been examined...</span>
<span class="go">edge (Chuck, Imothep) has been examined...</span>
<span class="go">edge (Chuck, Bob) has been examined...</span>
<span class="go">edge (Carlos, Eve) has been examined...</span>
<span class="go">edge (Carlos, Imothep) has been examined...</span>
<span class="go">edge (Carlos, Bob) has been examined...</span>
<span class="go">edge (Carlos, Alice) has been examined...</span>
<span class="go">edge (Carlos, Alice) has been relaxed...</span>
<span class="go">--&gt; Alice has been discovered!</span>
<span class="go">edge (Imothep, Carol) has been examined...</span>
<span class="go">edge (Imothep, Carlos) has been examined...</span>
<span class="go">edge (Imothep, Chuck) has been examined...</span>
<span class="go">edge (Imothep, Eve) has been examined...</span>
<span class="go">edge (Alice, Oscar) has been examined...</span>
<span class="go">edge (Alice, Oscar) has been relaxed...</span>
<span class="go">--&gt; Oscar has been discovered!</span>
<span class="go">edge (Alice, Dave) has been examined...</span>
<span class="go">edge (Alice, Dave) has been relaxed...</span>
<span class="go">--&gt; Dave has been discovered!</span>
<span class="go">edge (Alice, Carlos) has been examined...</span>
<span class="go">edge (Carol, Eve) has been examined...</span>
<span class="go">edge (Carol, Imothep) has been examined...</span>
<span class="go">edge (Oscar, Alice) has been examined...</span>
<span class="go">edge (Oscar, Dave) has been examined...</span>
<span class="go">edge (Dave, Oscar) has been examined...</span>
<span class="go">edge (Dave, Alice) has been examined...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="go">[0 7 6 3 2 9 1 4 8 5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="go">[0 3 6 0 0 1 0 0 1 6]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="go">[ 0.          8.91915887  9.27141329  4.29277116  4.02118246 12.23513866</span>
<span class="go">  3.23790211  3.45487436 11.04391549  7.74858396]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="graph_tool.search.dijkstra_iterator">
<code class="descclassname">graph_tool.search.</code><code class="descname">dijkstra_iterator</code><span class="sig-paren">(</span><em>g</em>, <em>weight</em>, <em>source=None</em>, <em>dist_map=None</em>, <em>combine=None</em>, <em>compare=None</em>, <em>zero=0</em>, <em>infinity=inf</em>, <em>array=False</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#dijkstra_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.dijkstra_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator of the edges corresponding to a Dijkstra traversal of
the graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Graph" title="graph_tool.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></p>
<blockquote>
<div><p>Graph to be used.</p>
</div></blockquote>
<p><strong>weight</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote>
<div><p>Edge property map with weight values.</p>
</div></blockquote>
<p><strong>source</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>Source vertex. If unspecified, all vertices will be traversed, by
iterating over starting vertices according to their index in increasing
order.</p>
</div></blockquote>
<p><strong>dist_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>A vertex property map where the distances from the source will be
stored.</p>
</div></blockquote>
<p><strong>combine</strong> : binary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code>)</p>
<blockquote>
<div><p>This function is used to combine distances to compute the distance of a
path.</p>
</div></blockquote>
<p><strong>compare</strong> : binary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code>)</p>
<blockquote>
<div><p>This function is use to compare distances to determine which vertex is
closer to the source vertex.</p>
</div></blockquote>
<p><strong>zero</strong> : int or float (optional, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p>
<blockquote>
<div><p>Value assumed to correspond to a distance of zero by the combine and
compare functions.</p>
</div></blockquote>
<p><strong>infinity</strong> : int or float (optional, default: <code class="docutils literal notranslate"><span class="pre">numpy.inf</span></code>)</p>
<blockquote>
<div><p>Value assumed to correspond to a distance of infinity by the combine
and compare functions.</p>
</div></blockquote>
<p><strong>array</strong> : <code class="docutils literal notranslate"><span class="pre">bool</span></code> (optional, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> will the edge endpoints be
returned instead.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dfs_iterator</strong> : Iterator or <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
<blockquote class="last">
<div><p>An iterator over the edges in Dijkstra order. If <code class="docutils literal notranslate"><span class="pre">array</span> <span class="pre">==</span> <span class="pre">True</span></code>,
this will be a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> instead, of shape <code class="docutils literal notranslate"><span class="pre">(E,2)</span></code>,
containing the edge endpoints.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="search_module.html#graph_tool.search.bfs_iterator" title="graph_tool.search.bfs_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfs_iterator</span></code></a></dt>
<dd>Breadth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dfs_iterator" title="graph_tool.search.dfs_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfs_iterator</span></code></a></dt>
<dd>Depth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.astar_iterator" title="graph_tool.search.astar_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astar_iterator</span></code></a></dt>
<dd><span class="math">\(A^*\)</span> heuristic search algorithm</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>See <a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_search" title="graph_tool.search.dijkstra_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">dijkstra_search()</span></code></a> for an explanation of the
algorithm.</p>
<p>The time complexity is <span class="math">\(O(1)\)</span> to create the generator and
<span class="math">\(O(E + V\log V)\)</span> to traverse it completely.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="dijkstra225" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id14">[dijkstra225]</a></td><td>E. Dijkstra, “A note on two problems in connexion with
graphs”, Numerische Mathematik, 1:269-271, 1959.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="dijkstra-bgl225" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id15">[dijkstra-bgl225]</a></td><td><a class="reference external" href="http://www.boost.org/doc/libs/release/libs/graph/doc/dijkstra_shortest_paths_no_color_map.html">http://www.boost.org/doc/libs/release/libs/graph/doc/dijkstra_shortest_paths_no_color_map.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="dijkstra-wikipedia225" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id16">[dijkstra-wikipedia225]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Dijkstra's_algorithm">http://en.wikipedia.org/wiki/Dijkstra’s_algorithm</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">gt</span><span class="o">.</span><span class="n">dijkstra_iterator</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">)):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()],</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()])</span>
<span class="go">Bob -&gt; Eve</span>
<span class="go">Bob -&gt; Chuck</span>
<span class="go">Bob -&gt; Carlos</span>
<span class="go">Bob -&gt; Isaac</span>
<span class="go">Eve -&gt; Imothep</span>
<span class="go">Eve -&gt; Carol</span>
<span class="go">Carlos -&gt; Alice</span>
<span class="go">Alice -&gt; Oscar</span>
<span class="go">Alice -&gt; Dave</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="graph_tool.search.BellmanFordVisitor">
<em class="property">class </em><code class="descclassname">graph_tool.search.</code><code class="descname">BellmanFordVisitor</code><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BellmanFordVisitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BellmanFordVisitor" title="Permalink to this definition">¶</a></dt>
<dd><p>A visitor object that is invoked at the event-points inside the
<a class="reference internal" href="search_module.html#graph_tool.search.bellman_ford_search" title="graph_tool.search.bellman_ford_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">bellman_ford_search()</span></code></a> algorithm. By default, it
performs no action, and should be used as a base class in order to be
useful.</p>
<dl class="method">
<dt id="graph_tool.search.BellmanFordVisitor.examine_edge">
<code class="descname">examine_edge</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BellmanFordVisitor.examine_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BellmanFordVisitor.examine_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on every edge in the graph <code class="docutils literal notranslate"><span class="pre">|V|</span></code> times.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BellmanFordVisitor.edge_relaxed">
<code class="descname">edge_relaxed</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BellmanFordVisitor.edge_relaxed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BellmanFordVisitor.edge_relaxed" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked when the distance label for the target vertex is
decreased. The edge (u,v) that participated in the last relaxation for
vertex v is an edge in the shortest paths tree.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BellmanFordVisitor.edge_not_relaxed">
<code class="descname">edge_not_relaxed</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BellmanFordVisitor.edge_not_relaxed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BellmanFordVisitor.edge_not_relaxed" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked if the distance label for the target vertex is not
decreased.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BellmanFordVisitor.edge_minimized">
<code class="descname">edge_minimized</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BellmanFordVisitor.edge_minimized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BellmanFordVisitor.edge_minimized" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked during the second stage of the algorithm, during the
test of whether each edge was minimized. If the edge is minimized then
this function is invoked.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.BellmanFordVisitor.edge_not_minimized">
<code class="descname">edge_not_minimized</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#BellmanFordVisitor.edge_not_minimized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.BellmanFordVisitor.edge_not_minimized" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked during the second stage of the algorithm, during the
test of whether each edge was minimized. If the edge was not minimized,
this function is invoked. This happens when there is a negative cycle in
the graph.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="graph_tool.search.bellman_ford_search">
<code class="descclassname">graph_tool.search.</code><code class="descname">bellman_ford_search</code><span class="sig-paren">(</span><em>g</em>, <em>source</em>, <em>weight</em>, <em>visitor=&lt;graph_tool.search.BellmanFordVisitor object&gt;</em>, <em>dist_map=None</em>, <em>pred_map=None</em>, <em>combine=&lt;function &lt;lambda&gt;&gt;</em>, <em>compare=&lt;function &lt;lambda&gt;&gt;</em>, <em>zero=0</em>, <em>infinity=inf</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#bellman_ford_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.bellman_ford_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Bellman-Ford traversal of a directed or undirected graph, with negative weights.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Graph" title="graph_tool.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></p>
<blockquote>
<div><p>Graph to be used.</p>
</div></blockquote>
<p><strong>source</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a></p>
<blockquote>
<div><p>Source vertex.</p>
</div></blockquote>
<p><strong>weight</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote>
<div><p>Edge property map with weight values.</p>
</div></blockquote>
<p><strong>visitor</strong> : <a class="reference internal" href="search_module.html#graph_tool.search.DijkstraVisitor" title="graph_tool.search.DijkstraVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DijkstraVisitor</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">DijkstraVisitor()</span></code>)</p>
<blockquote>
<div><p>A visitor object that is invoked at the event points inside the
algorithm. This should be a subclass of
<a class="reference internal" href="search_module.html#graph_tool.search.DijkstraVisitor" title="graph_tool.search.DijkstraVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DijkstraVisitor</span></code></a>.</p>
</div></blockquote>
<p><strong>dist_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>A vertex property map where the distances from the source will be
stored.</p>
</div></blockquote>
<p><strong>pred_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>A vertex property map where the predecessor map will be
stored (must have value type “int64_t”).</p>
</div></blockquote>
<p><strong>combine</strong> : binary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code>)</p>
<blockquote>
<div><p>This function is used to combine distances to compute the distance of a
path.</p>
</div></blockquote>
<p><strong>compare</strong> : binary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code>)</p>
<blockquote>
<div><p>This function is use to compare distances to determine which vertex is
closer to the source vertex.</p>
</div></blockquote>
<p><strong>zero</strong> : int or float (optional, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p>
<blockquote>
<div><p>Value assumed to correspond to a distance of zero by the combine and
compare functions.</p>
</div></blockquote>
<p><strong>infinity</strong> : int or float (optional, default: <code class="docutils literal notranslate"><span class="pre">float('inf')</span></code>)</p>
<blockquote>
<div><p>Value assumed to correspond to a distance of infinity by the combine and
compare functions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>minimized</strong> : bool</p>
<blockquote>
<div><p>True if all edges were successfully minimized, or False if there is a
negative loop in the graph.</p>
</div></blockquote>
<p><strong>dist_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote>
<div><p>A vertex property map with the computed distances from the source.</p>
</div></blockquote>
<p><strong>pred_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote class="last">
<div><p>A vertex property map with the predecessor tree.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="search_module.html#graph_tool.search.bfs_search" title="graph_tool.search.bfs_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfs_search</span></code></a></dt>
<dd>Breadth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dfs_search" title="graph_tool.search.dfs_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfs_search</span></code></a></dt>
<dd>Depth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_search" title="graph_tool.search.dijkstra_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dijkstra_search</span></code></a></dt>
<dd>Dijkstra search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.astar_search" title="graph_tool.search.astar_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astar_search</span></code></a></dt>
<dd><span class="math">\(A^*\)</span> heuristic search</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The Bellman-Ford algorithm <a class="reference internal" href="search_module.html#bellman-ford228" id="id17">[bellman-ford228]</a> solves the single-source shortest
paths problem for a graph with both positive and negative edge weights. If
you only need to solve the shortest paths problem for positive edge weights,
<a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_search" title="graph_tool.search.dijkstra_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">dijkstra_search()</span></code></a> provides a more efficient
alternative. If all the edge weights are all equal, then
<a class="reference internal" href="search_module.html#graph_tool.search.bfs_search" title="graph_tool.search.bfs_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">bfs_search()</span></code></a> provides an even more efficient
alternative.</p>
<p>The Bellman-Ford algorithm proceeds by looping through all of the edges in
the graph, applying the relaxation operation to each edge. In the following
pseudo-code, <code class="docutils literal notranslate"><span class="pre">v</span></code> is a vertex adjacent to <code class="docutils literal notranslate"><span class="pre">u</span></code>, <code class="docutils literal notranslate"><span class="pre">w</span></code> maps edges to their
weight, and <code class="docutils literal notranslate"><span class="pre">d</span></code> is a distance map that records the length of the shortest
path to each vertex seen so far. <code class="docutils literal notranslate"><span class="pre">p</span></code> is a predecessor map which records
the parent of each vertex, which will ultimately be the parent in the
shortest paths tree</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">RELAX</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
    <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">w</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>       <span class="n">relax</span> <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
    <span class="n">p</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">u</span>
  <span class="k">else</span>
    <span class="o">...</span>                         <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">relaxed</span>
</pre></div>
</div>
<p>The algorithm repeats this loop <code class="docutils literal notranslate"><span class="pre">|V|</span></code> times after which it is guaranteed
that the distances to each vertex have been reduced to the minimum possible
unless there is a negative cycle in the graph. If there is a negative cycle,
then there will be edges in the graph that were not properly minimized. That
is, there will be edges <code class="docutils literal notranslate"><span class="pre">(u,v)</span></code> such that <code class="docutils literal notranslate"><span class="pre">w(u,v)</span> <span class="pre">+</span> <span class="pre">d[u]</span> <span class="pre">&lt;</span> <span class="pre">d[v]</span></code>. The
algorithm loops over the edges in the graph one final time to check if all
the edges were minimized, returning true if they were and returning false
otherwise.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">BELLMAN</span><span class="o">-</span><span class="n">FORD</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">each</span> <span class="n">vertex</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">V</span>
    <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">infinity</span>
    <span class="n">p</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">u</span>
  <span class="n">end</span> <span class="k">for</span>
  <span class="k">for</span> <span class="n">i</span> <span class="p">:</span><span class="o">=</span> <span class="mi">1</span> <span class="n">to</span> <span class="o">|</span><span class="n">V</span><span class="o">|-</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">each</span> <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">E</span>          <span class="n">examine</span> <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
      <span class="n">RELAX</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
    <span class="n">end</span> <span class="k">for</span>
  <span class="n">end</span> <span class="k">for</span>
  <span class="k">for</span> <span class="n">each</span> <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">E</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
      <span class="k">return</span> <span class="p">(</span><span class="n">false</span><span class="p">,</span> <span class="p">,</span> <span class="p">)</span>              <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">minimized</span>
    <span class="k">else</span>
      <span class="o">...</span>                             <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="n">was</span> <span class="n">minimized</span>
  <span class="n">end</span> <span class="k">for</span>
  <span class="k">return</span> <span class="p">(</span><span class="n">true</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
<p>The time complexity is <span class="math">\(O(V E)\)</span>.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="bellman-ford228" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[bellman-ford228]</td><td><em>(<a class="fn-backref" href="search_module.html#id17">1</a>, <a class="fn-backref" href="search_module.html#id18">2</a>)</em> R. Bellman, “On a routing problem”, Quarterly of Applied
Mathematics, 16(1):87-90, 1958.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bellman-ford-bgl228" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id19">[bellman-ford-bgl228]</a></td><td><a class="reference external" href="http://www.boost.org/doc/libs/release/libs/graph/doc/bellman_ford_shortest.html">http://www.boost.org/doc/libs/release/libs/graph/doc/bellman_ford_shortest.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bellman-ford-wikipedia228" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id20">[bellman-ford-wikipedia228]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/Bellman-Ford_algorithm">http://en.wikipedia.org/wiki/Bellman-Ford_algorithm</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>We must define what should be done during the search by subclassing
<a class="reference internal" href="search_module.html#graph_tool.search.BellmanFordVisitor" title="graph_tool.search.BellmanFordVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">BellmanFordVisitor</span></code></a>, and specializing the
appropriate methods. In the following we will keep track of the edge
minimizations.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">VisitorExample</span><span class="p">(</span><span class="n">gt</span><span class="o">.</span><span class="n">BellmanFordVisitor</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">edge_minimized</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;edge (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">) has been minimized...&quot;</span> <span class="o">%</span> \
              <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]))</span>

    <span class="k">def</span> <span class="nf">edge_not_minimized</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;edge (</span><span class="si">%s</span><span class="s2">, </span><span class="si">%s</span><span class="s2">) has not been minimized...&quot;</span> <span class="o">%</span> \
              <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()],</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]))</span>
</pre></div>
</div>
<p>With the above class defined, we can perform the Bellman-Ford search as
follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nweight</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">copy_property</span><span class="p">(</span><span class="n">weight</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nweight</span><span class="o">.</span><span class="n">a</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>   <span class="c1"># include negative weight in edge (Carlos, Alice)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minimized</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">bellman_ford_search</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">nweight</span><span class="p">,</span> <span class="n">VisitorExample</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
<span class="go">edge (Bob, Eve) has been minimized...</span>
<span class="go">edge (Bob, Chuck) has been minimized...</span>
<span class="go">edge (Bob, Carlos) has been minimized...</span>
<span class="go">edge (Bob, Isaac) has been minimized...</span>
<span class="go">edge (Alice, Oscar) has been minimized...</span>
<span class="go">edge (Alice, Dave) has been minimized...</span>
<span class="go">edge (Alice, Carlos) has been minimized...</span>
<span class="go">edge (Carol, Eve) has been minimized...</span>
<span class="go">edge (Carol, Imothep) has been minimized...</span>
<span class="go">edge (Carlos, Eve) has been minimized...</span>
<span class="go">edge (Carlos, Imothep) has been minimized...</span>
<span class="go">edge (Chuck, Eve) has been minimized...</span>
<span class="go">edge (Chuck, Isaac) has been minimized...</span>
<span class="go">edge (Chuck, Imothep) has been minimized...</span>
<span class="go">edge (Dave, Oscar) has been minimized...</span>
<span class="go">edge (Eve, Isaac) has been minimized...</span>
<span class="go">edge (Eve, Imothep) has been minimized...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">minimized</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pred</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="go">[3 3 9 1 6 1 3 6 1 3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="go">[-28.42555934 -37.34471821 -25.20438243 -41.97110592 -35.20316571</span>
<span class="go"> -34.02873843 -36.58860946 -33.55645565 -35.2199616  -36.0029274 ]</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="graph_tool.search.AStarVisitor">
<em class="property">class </em><code class="descclassname">graph_tool.search.</code><code class="descname">AStarVisitor</code><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#AStarVisitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.AStarVisitor" title="Permalink to this definition">¶</a></dt>
<dd><p>A visitor object that is invoked at the event-points inside the
<a class="reference internal" href="search_module.html#graph_tool.search.astar_search" title="graph_tool.search.astar_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">astar_search()</span></code></a> algorithm. By default, it
performs no action, and should be used as a base class in order to be
useful.</p>
<dl class="method">
<dt id="graph_tool.search.AStarVisitor.initialize_vertex">
<code class="descname">initialize_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#AStarVisitor.initialize_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.AStarVisitor.initialize_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on every vertex of the graph before the start of the
graph search.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.AStarVisitor.examine_vertex">
<code class="descname">examine_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#AStarVisitor.examine_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.AStarVisitor.examine_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on a vertex as it is popped from the queue (i.e. it
has the lowest cost on the <code class="docutils literal notranslate"><span class="pre">OPEN</span></code> list). This happens immediately
before examine_edge() is invoked on each of the out-edges of vertex u.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.AStarVisitor.examine_edge">
<code class="descname">examine_edge</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#AStarVisitor.examine_edge"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.AStarVisitor.examine_edge" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on every out-edge of each vertex after it is examined.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.AStarVisitor.discover_vertex">
<code class="descname">discover_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#AStarVisitor.discover_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.AStarVisitor.discover_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked when a vertex is first discovered and is added to the
<code class="docutils literal notranslate"><span class="pre">OPEN</span></code> list.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.AStarVisitor.edge_relaxed">
<code class="descname">edge_relaxed</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#AStarVisitor.edge_relaxed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.AStarVisitor.edge_relaxed" title="Permalink to this definition">¶</a></dt>
<dd><p>Upon examination, if the following condition holds then the edge is
relaxed (its distance is reduced), and this method is invoked.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<span class="k">assert</span><span class="p">(</span><span class="n">compare</span><span class="p">(</span><span class="n">combine</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">],</span> <span class="n">weight</span><span class="p">[</span><span class="n">e</span><span class="p">]),</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.AStarVisitor.edge_not_relaxed">
<code class="descname">edge_not_relaxed</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#AStarVisitor.edge_not_relaxed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.AStarVisitor.edge_not_relaxed" title="Permalink to this definition">¶</a></dt>
<dd><p>Upon examination, if the edge is not relaxed (see
<a class="reference internal" href="search_module.html#graph_tool.search.AStarVisitor.edge_relaxed" title="graph_tool.search.AStarVisitor.edge_relaxed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">edge_relaxed()</span></code></a>) then this
method is invoked.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.AStarVisitor.black_target">
<code class="descname">black_target</code><span class="sig-paren">(</span><em>e</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#AStarVisitor.black_target"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.AStarVisitor.black_target" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked when a vertex that is on the <code class="docutils literal notranslate"><span class="pre">CLOSED</span></code> list is
“rediscovered” via a more efficient path, and is re-added to the
<code class="docutils literal notranslate"><span class="pre">OPEN</span></code> list.</p>
</dd></dl>

<dl class="method">
<dt id="graph_tool.search.AStarVisitor.finish_vertex">
<code class="descname">finish_vertex</code><span class="sig-paren">(</span><em>u</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#AStarVisitor.finish_vertex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.AStarVisitor.finish_vertex" title="Permalink to this definition">¶</a></dt>
<dd><p>This is invoked on a vertex when it is added to the CLOSED list,
which happens after all of its out edges have been examined.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="graph_tool.search.astar_search">
<code class="descclassname">graph_tool.search.</code><code class="descname">astar_search</code><span class="sig-paren">(</span><em>g</em>, <em>source</em>, <em>weight</em>, <em>visitor=&lt;graph_tool.search.AStarVisitor object&gt;</em>, <em>heuristic=&lt;function &lt;lambda&gt;&gt;</em>, <em>dist_map=None</em>, <em>pred_map=None</em>, <em>cost_map=None</em>, <em>combine=&lt;function &lt;lambda&gt;&gt;</em>, <em>compare=&lt;function &lt;lambda&gt;&gt;</em>, <em>zero=0</em>, <em>infinity=inf</em>, <em>implicit=False</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#astar_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.astar_search" title="Permalink to this definition">¶</a></dt>
<dd><p>Heuristic <span class="math">\(A^*\)</span> search on a weighted, directed or undirected graph for the case where all edge weights are non-negative.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Graph" title="graph_tool.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></p>
<blockquote>
<div><p>Graph to be used.</p>
</div></blockquote>
<p><strong>source</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a></p>
<blockquote>
<div><p>Source vertex.</p>
</div></blockquote>
<p><strong>weight</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote>
<div><p>Edge property map with weight values.</p>
</div></blockquote>
<p><strong>visitor</strong> : <a class="reference internal" href="search_module.html#graph_tool.search.AStarVisitor" title="graph_tool.search.AStarVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">AStarVisitor</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">AStarVisitor()</span></code>)</p>
<blockquote>
<div><p>A visitor object that is invoked at the event points inside the
algorithm. This should be a subclass of
<a class="reference internal" href="search_module.html#graph_tool.search.AStarVisitor" title="graph_tool.search.AStarVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">AStarVisitor</span></code></a>.</p>
</div></blockquote>
<p><strong>heuristic</strong> : unary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">v:</span> <span class="pre">1</span></code>)</p>
<blockquote>
<div><p>The heuristic function that guides the search. It should take a single
argument which is a <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a>, and output an estimated
distance from the supplied vertex to the target vertex.</p>
</div></blockquote>
<p><strong>dist_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>A vertex property map where the distances from the source will be
stored.</p>
</div></blockquote>
<p><strong>pred_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>A vertex property map where the predecessor map will be
stored (must have value type “int64_t”).</p>
</div></blockquote>
<p><strong>cost_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>A vertex property map where the vertex costs will be stored. It must
have the same value type as <code class="docutils literal notranslate"><span class="pre">dist_map</span></code>. This parameter is only used if
<code class="docutils literal notranslate"><span class="pre">implicit</span></code> is True.</p>
</div></blockquote>
<p><strong>combine</strong> : binary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code>)</p>
<blockquote>
<div><p>This function is used to combine distances to compute the distance of a
path.</p>
</div></blockquote>
<p><strong>compare</strong> : binary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code>)</p>
<blockquote>
<div><p>This function is use to compare distances to determine which vertex is
closer to the source vertex.</p>
</div></blockquote>
<p><strong>implicit</strong> : bool (optional, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
<blockquote>
<div><p>If true, the underlying graph will be assumed to be implicit
(i.e. constructed during the search).</p>
</div></blockquote>
<p><strong>zero</strong> : int or float (optional, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p>
<blockquote>
<div><p>Value assumed to correspond to a distance of zero by the combine and
compare functions.</p>
</div></blockquote>
<p><strong>infinity</strong> : int or float (optional, default: <code class="docutils literal notranslate"><span class="pre">float('inf')</span></code>)</p>
<blockquote>
<div><p>Value assumed to correspond to a distance of infinity by the combine and
compare functions.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>dist_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote>
<div><p>A vertex property map with the computed distances from the source.</p>
</div></blockquote>
<p><strong>pred_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote class="last">
<div><p>A vertex property map with the predecessor tree.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="search_module.html#graph_tool.search.bfs_search" title="graph_tool.search.bfs_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfs_search</span></code></a></dt>
<dd>Breadth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dfs_search" title="graph_tool.search.dfs_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfs_search</span></code></a></dt>
<dd>Depth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_search" title="graph_tool.search.dijkstra_search"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dijkstra_search</span></code></a></dt>
<dd>Dijkstra’s search algorithm</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>The <span class="math">\(A^*\)</span> algorithm is a heuristic graph search algorithm: an
<span class="math">\(A^*\)</span> search is “guided” by a heuristic function. A heuristic function
<span class="math">\(h(v)\)</span> is one which estimates the cost from a non-goal state (v) in
the graph to some goal state, t. Intuitively, <span class="math">\(A^*\)</span> follows paths
(through the graph) to the goal that are estimated by the heuristic function
to be the best paths. Unlike best-first search, <span class="math">\(A^*\)</span> takes into
account the known cost from the start of the search to v; the paths
<span class="math">\(A^*\)</span> takes are guided by a function <span class="math">\(f(v) = g(v) + h(v)\)</span>, where
<span class="math">\(h(v)\)</span> is the heuristic function, and <span class="math">\(g(v)\)</span> (sometimes denoted
<span class="math">\(c(s, v)\)</span>) is the known cost from the start to v. Clearly, the
efficiency of <span class="math">\(A^*\)</span> is highly dependent on the heuristic function with
which it is used.</p>
<p>The time complexity is <span class="math">\(O((E + V)\log V)\)</span>.</p>
<p>The pseudo-code for the <span class="math">\(A^*\)</span> algorithm is listed below, with the
annotated event points, for which the given visitor object will be called
with the appropriate method.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">*</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">source</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">each</span> <span class="n">vertex</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">V</span>                 <span class="n">initialize</span> <span class="n">vertex</span> <span class="n">u</span>
    <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">infinity</span>
    <span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">WHITE</span>
  <span class="n">end</span> <span class="k">for</span>
  <span class="n">color</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">GRAY</span>
  <span class="n">d</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="mi">0</span>
  <span class="n">f</span><span class="p">[</span><span class="n">s</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">h</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
  <span class="n">INSERT</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">source</span><span class="p">)</span>                      <span class="n">discover</span> <span class="n">vertex</span> <span class="n">source</span>
  <span class="k">while</span> <span class="p">(</span><span class="n">Q</span> <span class="o">!=</span> <span class="n">Ø</span><span class="p">)</span>
    <span class="n">u</span> <span class="p">:</span><span class="o">=</span> <span class="n">EXTRACT</span><span class="o">-</span><span class="n">MIN</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>                  <span class="n">examine</span> <span class="n">vertex</span> <span class="n">u</span>
    <span class="k">for</span> <span class="n">each</span> <span class="n">vertex</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">Adj</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>          <span class="n">examine</span> <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
      <span class="k">if</span> <span class="p">(</span><span class="n">w</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
        <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">w</span><span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="o">+</span> <span class="n">d</span><span class="p">[</span><span class="n">u</span><span class="p">]</span>            <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="n">relaxed</span>
        <span class="n">f</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">+</span> <span class="n">h</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">WHITE</span><span class="p">)</span>
          <span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">GRAY</span>
          <span class="n">INSERT</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>                   <span class="n">discover</span> <span class="n">vertex</span> <span class="n">v</span>
        <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">BLACK</span><span class="p">)</span>
          <span class="n">color</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">GRAY</span>
          <span class="n">INSERT</span><span class="p">(</span><span class="n">Q</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>                   <span class="n">reopen</span> <span class="n">vertex</span> <span class="n">v</span>
        <span class="n">end</span> <span class="k">if</span>
      <span class="k">else</span>
        <span class="o">...</span>                              <span class="n">edge</span> <span class="p">(</span><span class="n">u</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">not</span> <span class="n">relaxed</span>
    <span class="n">end</span> <span class="k">for</span>
    <span class="n">color</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="p">:</span><span class="o">=</span> <span class="n">BLACK</span>                    <span class="n">finish</span> <span class="n">vertex</span> <span class="n">u</span>
  <span class="n">end</span> <span class="k">while</span>
</pre></div>
</div>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="astar231" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id21">[astar231]</a></td><td>Hart, P. E.; Nilsson, N. J.; Raphael, B. “A Formal Basis for the
Heuristic Determination of Minimum Cost Paths”. IEEE Transactions on
Systems Science and Cybernetics SSC4 4 (2): 100-107, 1968.
<a class="reference external" href="https://dx.doi.org/10.1109/TSSC.1968.300136">DOI: 10.1109/TSSC.1968.300136</a> [<a class="reference external" href="https://sci-hub.tw/10.1109/TSSC.1968.300136">sci-hub</a>, <a class="reference external" href="https://scihub22266oqcxt.onion.link/10.1109/TSSC.1968.300136">&#64;tor</a>]</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="astar-bgl231" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id22">[astar-bgl231]</a></td><td><a class="reference external" href="http://www.boost.org/doc/libs/release/libs/graph/doc/astar_search.html">http://www.boost.org/doc/libs/release/libs/graph/doc/astar_search.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="astar-wikipedia231" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id23">[astar-wikipedia231]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/A*_search_algorithm">http://en.wikipedia.org/wiki/A*_search_algorithm</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>We will use an irregular two-dimensional lattice as an example, where the
heuristic function will be based on the euclidean distance to the target.</p>
<p>The heuristic function will be defined as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">pos</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">a</span> <span class="o">-</span> <span class="n">pos</span><span class="p">[</span><span class="n">target</span><span class="p">]</span><span class="o">.</span><span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">pos</span></code> is the vertex position in the plane.</p>
<p>We must define what should be done during the search by subclassing
<a class="reference internal" href="search_module.html#graph_tool.search.AStarVisitor" title="graph_tool.search.AStarVisitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">AStarVisitor</span></code></a>, and specializing the appropriate
methods. In the following we will keep track of the discovered vertices, and
which edges were examined, as well as the predecessor tree. We will also
abort the search when a given target vertex is found, by raising the
<a class="reference internal" href="search_module.html#graph_tool.search.StopSearch" title="graph_tool.search.StopSearch"><code class="xref py py-class docutils literal notranslate"><span class="pre">StopSearch</span></code></a> exception.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">VisitorExample</span><span class="p">(</span><span class="n">gt</span><span class="o">.</span><span class="n">AStarVisitor</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">touched_v</span><span class="p">,</span> <span class="n">touched_e</span><span class="p">,</span> <span class="n">target</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">touched_v</span> <span class="o">=</span> <span class="n">touched_v</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">touched_e</span> <span class="o">=</span> <span class="n">touched_e</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target</span>

    <span class="k">def</span> <span class="nf">discover_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">touched_v</span><span class="p">[</span><span class="n">u</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">examine_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">touched_e</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>

    <span class="k">def</span> <span class="nf">edge_relaxed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">gt</span><span class="o">.</span><span class="n">StopSearch</span><span class="p">()</span>
</pre></div>
</div>
<p>With the above class defined, we can perform the <span class="math">\(A^*\)</span> search as
follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">points</span> <span class="o">=</span> <span class="n">random</span><span class="p">((</span><span class="mi">500</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span> <span class="o">*</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.01</span><span class="p">,</span> <span class="mf">4.01</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">triangulation</span><span class="p">(</span><span class="n">points</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;delaunay&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_edge_property</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">)</span> <span class="c1"># Edge weights corresponding to</span>
<span class="gp">... </span>                                       <span class="c1"># Euclidean distances</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">weight</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">((</span><span class="n">pos</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()]</span><span class="o">.</span><span class="n">a</span> <span class="o">-</span>
<span class="gp">... </span>                         <span class="n">pos</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]</span><span class="o">.</span><span class="n">a</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">touch_v</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">&quot;bool&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">touch_e</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_edge_property</span><span class="p">(</span><span class="s2">&quot;bool&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">astar_search</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">weight</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">VisitorExample</span><span class="p">(</span><span class="n">touch_v</span><span class="p">,</span> <span class="n">touch_e</span><span class="p">,</span> <span class="n">target</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">heuristic</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">h</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">pos</span><span class="p">))</span>
</pre></div>
</div>
<p>We can now observe the best path found, and how many vertices and edges were
visited in the process.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ecolor</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_edge_property</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ewidth</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_edge_property</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ewidth</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">ecolor</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#3465a4&quot;</span> <span class="k">if</span> <span class="n">touch_e</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="k">else</span> <span class="s2">&quot;#d3d7cf&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">target</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="n">v</span> <span class="o">!=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">p</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">out_edges</span><span class="p">():</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()</span> <span class="o">==</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">ecolor</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#a40000&quot;</span>
<span class="gp">... </span>            <span class="n">ewidth</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">... </span>    <span class="n">v</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gt</span><span class="o">.</span><span class="n">graph_draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">touch_v</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">vcmap</span><span class="o">=</span><span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">binary</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="n">ecolor</span><span class="p">,</span>
<span class="gp">... </span>              <span class="n">edge_pen_width</span><span class="o">=</span><span class="n">ewidth</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;astar-delaunay.pdf&quot;</span><span class="p">)</span>
<span class="go">&lt;...&gt;</span>
</pre></div>
</div>
<div class="figure align-center" id="id28">
<img alt="_images/astar-delaunay.png" src="../static/doc/_images/astar-delaunay.png" />
<p class="caption"><span class="caption-text">The shortest path is shown in red. The visited edges are shown in blue,
and the visited vertices in black.</span></p>
</div>
<p>The <span class="math">\(A^*\)</span> algorithm is very useful for searching <em>implicit</em> graphs,
i.e. graphs which are not entirely stored in memory and are generated
“on-the-fly” during the search. In the following example we will carry out a
search in a hamming hypercube of 10 bits witch has random weights on its
edges in the range <span class="math">\([0,1]\)</span>. The vertices of the hypercube will be
created during the search.</p>
<p>The heuristic function will use the Hamming distance between vertices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">state</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">state</span><span class="p">[</span><span class="n">v</span><span class="p">]</span><span class="o">.</span><span class="n">a</span> <span class="o">-</span> <span class="n">target</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
</pre></div>
</div>
<p>In the following visitor we will keep growing the graph on-the-fly, and
abort the search when a given target vertex is found, by raising the
<a class="reference internal" href="search_module.html#graph_tool.search.StopSearch" title="graph_tool.search.StopSearch"><code class="xref py py-class docutils literal notranslate"><span class="pre">StopSearch</span></code></a> exception.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy.random</span> <span class="kn">import</span> <span class="n">random</span>

<span class="k">class</span> <span class="nc">HammingVisitor</span><span class="p">(</span><span class="n">gt</span><span class="o">.</span><span class="n">AStarVisitor</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">cost</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">g</span> <span class="o">=</span> <span class="n">g</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="n">state</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">target</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">weight</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="n">dist</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cost</span> <span class="o">=</span> <span class="n">cost</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visited</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">examine_vertex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">u</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">u</span><span class="p">])):</span>
            <span class="n">nstate</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">u</span><span class="p">])</span>
            <span class="n">nstate</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">^=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">nstate</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">visited</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">visited</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">nstate</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">visited</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">nstate</span><span class="p">)]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="n">nstate</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dist</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cost</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">out_edges</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="n">random</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">visited</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">u</span><span class="p">])]</span> <span class="o">=</span> <span class="n">u</span>

    <span class="k">def</span> <span class="nf">edge_relaxed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">visited</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">target</span><span class="p">)]</span> <span class="o">=</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()</span>
            <span class="k">raise</span> <span class="n">gt</span><span class="o">.</span><span class="n">StopSearch</span><span class="p">()</span>
</pre></div>
</div>
<p>With the above class defined, we can perform the <span class="math">\(A^*\)</span> search as
follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">Graph</span><span class="p">(</span><span class="n">directed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">&quot;vector&lt;bool&gt;&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">add_vertex</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_edge_property</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cost</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">visitor</span> <span class="o">=</span> <span class="n">HammingVisitor</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">state</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">dist</span><span class="p">,</span> <span class="n">cost</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dist</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">astar_search</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">weight</span><span class="p">,</span> <span class="n">visitor</span><span class="p">,</span> <span class="n">dist_map</span><span class="o">=</span><span class="n">dist</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">cost_map</span><span class="o">=</span><span class="n">cost</span><span class="p">,</span> <span class="n">heuristic</span><span class="o">=</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">h</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">array</span><span class="p">(</span><span class="n">target</span><span class="p">),</span> <span class="n">state</span><span class="p">),</span>
<span class="gp">... </span>                             <span class="n">implicit</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>We can now observe the best path found, and how many vertices and edges were
visited in the process.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ecolor</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_edge_property</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vcolor</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_vertex_property</span><span class="p">(</span><span class="s2">&quot;string&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ewidth</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">new_edge_property</span><span class="p">(</span><span class="s2">&quot;double&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ewidth</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">ecolor</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">vertices</span><span class="p">():</span>
<span class="gp">... </span>   <span class="n">vcolor</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;white&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">visitor</span><span class="o">.</span><span class="n">visited</span><span class="p">[</span><span class="nb">tuple</span><span class="p">(</span><span class="n">target</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">while</span> <span class="n">v</span> <span class="o">!=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">vcolor</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span>
<span class="gp">... </span>    <span class="n">p</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">v</span><span class="p">])</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">v</span><span class="o">.</span><span class="n">out_edges</span><span class="p">():</span>
<span class="gp">... </span>        <span class="k">if</span> <span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()</span> <span class="o">==</span> <span class="n">p</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">ecolor</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;#a40000&quot;</span>
<span class="gp">... </span>            <span class="n">ewidth</span><span class="p">[</span><span class="n">e</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">... </span>    <span class="n">v</span> <span class="o">=</span> <span class="n">p</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vcolor</span><span class="p">[</span><span class="n">v</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;black&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pos</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">graph_draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="n">vertex_fill_color</span><span class="o">=</span><span class="n">vcolor</span><span class="p">,</span> <span class="n">edge_color</span><span class="o">=</span><span class="n">ecolor</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">edge_pen_width</span><span class="o">=</span><span class="n">ewidth</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;astar-implicit.pdf&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure align-center" id="id29">
<img alt="_images/astar-implicit.png" src="../static/doc/_images/astar-implicit.png" />
<p class="caption"><span class="caption-text">The shortest path is shown in red, and the vertices which belong to it
are in black. Note that the number of vertices visited is much smaller
than the total number <span class="math">\(2^{10} = 1024\)</span>.</span></p>
</div>
</dd></dl>

<dl class="function">
<dt id="graph_tool.search.astar_iterator">
<code class="descclassname">graph_tool.search.</code><code class="descname">astar_iterator</code><span class="sig-paren">(</span><em>g</em>, <em>source</em>, <em>weight</em>, <em>heuristic=&lt;function &lt;lambda&gt;&gt;</em>, <em>dist_map=None</em>, <em>combine=None</em>, <em>compare=None</em>, <em>zero=0</em>, <em>infinity=inf</em>, <em>array=False</em><span class="sig-paren">)</span><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#astar_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.astar_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an iterator of the edges corresponding to an <span class="math">\(A^*\)</span> traversal of
the graph.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>g</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Graph" title="graph_tool.Graph"><code class="xref py py-class docutils literal notranslate"><span class="pre">Graph</span></code></a></p>
<blockquote>
<div><p>Graph to be used.</p>
</div></blockquote>
<p><strong>source</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a></p>
<blockquote>
<div><p>Source vertex.</p>
</div></blockquote>
<p><strong>weight</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a></p>
<blockquote>
<div><p>Edge property map with weight values.</p>
</div></blockquote>
<p><strong>heuristic</strong> : unary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">v:</span> <span class="pre">1</span></code>)</p>
<blockquote>
<div><p>The heuristic function that guides the search. It should take a single
argument which is a <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.Vertex" title="graph_tool.Vertex"><code class="xref py py-class docutils literal notranslate"><span class="pre">Vertex</span></code></a>, and output an estimated
distance from the supplied vertex to the target vertex.</p>
</div></blockquote>
<p><strong>dist_map</strong> : <a class="reference internal" href="https://graph-tool.skewed.de/static/doc/graph_tool.html#graph_tool.PropertyMap" title="graph_tool.PropertyMap"><code class="xref py py-class docutils literal notranslate"><span class="pre">PropertyMap</span></code></a> (optional, default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
<blockquote>
<div><p>A vertex property map where the distances from the source will be
stored.</p>
</div></blockquote>
<p><strong>combine</strong> : binary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code>)</p>
<blockquote>
<div><p>This function is used to combine distances to compute the distance of a
path.</p>
</div></blockquote>
<p><strong>compare</strong> : binary function (optional, default: <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a</span> <span class="pre">&lt;</span> <span class="pre">b</span></code>)</p>
<blockquote>
<div><p>This function is use to compare distances to determine which vertex is
closer to the source vertex.</p>
</div></blockquote>
<p><strong>zero</strong> : int or float (optional, default: <code class="docutils literal notranslate"><span class="pre">0</span></code>)</p>
<blockquote>
<div><p>Value assumed to correspond to a distance of zero by the combine and
compare functions.</p>
</div></blockquote>
<p><strong>infinity</strong> : int or float (optional, default: <code class="docutils literal notranslate"><span class="pre">numpy.inf</span></code>)</p>
<blockquote>
<div><p>Value assumed to correspond to a distance of infinity by the combine
and compare functions.</p>
</div></blockquote>
<p><strong>array</strong> : <code class="docutils literal notranslate"><span class="pre">bool</span></code> (optional, default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p>
<blockquote>
<div><p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> will the edge endpoints be
returned instead.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>astar_iterator</strong> : Iterator or <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
<blockquote class="last">
<div><p>An iterator over the edges in <span class="math">\(A^*\)</span> order. If <code class="docutils literal notranslate"><span class="pre">array</span> <span class="pre">==</span> <span class="pre">True</span></code>,
this will be a <a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> instead, of shape <code class="docutils literal notranslate"><span class="pre">(E,2)</span></code>,
containing the edge endpoints.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<dl class="last docutils">
<dt><a class="reference internal" href="search_module.html#graph_tool.search.bfs_iterator" title="graph_tool.search.bfs_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfs_iterator</span></code></a></dt>
<dd>Breadth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dfs_iterator" title="graph_tool.search.dfs_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dfs_iterator</span></code></a></dt>
<dd>Depth-first search</dd>
<dt><a class="reference internal" href="search_module.html#graph_tool.search.dijkstra_iterator" title="graph_tool.search.dijkstra_iterator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dijkstra_iterator</span></code></a></dt>
<dd>Dijkstra search algorithm</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>See <a class="reference internal" href="search_module.html#graph_tool.search.astar_search" title="graph_tool.search.astar_search"><code class="xref py py-func docutils literal notranslate"><span class="pre">astar_search()</span></code></a> for an explanation of the
algorithm.</p>
<p>The time complexity is <span class="math">\(O(1)\)</span> to create the generator and
<span class="math">\(O((E + V)\log V)\)</span> to traverse it completely.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="astar234" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id24">[astar234]</a></td><td>Hart, P. E.; Nilsson, N. J.; Raphael, B. “A Formal Basis for the
Heuristic Determination of Minimum Cost Paths”. IEEE Transactions on
Systems Science and Cybernetics SSC4 4 (2): 100-107, 1968.
<a class="reference external" href="https://dx.doi.org/10.1109/TSSC.1968.300136">DOI: 10.1109/TSSC.1968.300136</a> [<a class="reference external" href="https://sci-hub.tw/10.1109/TSSC.1968.300136">sci-hub</a>, <a class="reference external" href="https://scihub22266oqcxt.onion.link/10.1109/TSSC.1968.300136">&#64;tor</a>]</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="astar-bgl234" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id25">[astar-bgl234]</a></td><td><a class="reference external" href="http://www.boost.org/doc/libs/release/libs/graph/doc/astar_search.html">http://www.boost.org/doc/libs/release/libs/graph/doc/astar_search.html</a></td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="astar-wikipedia234" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="search_module.html#id26">[astar-wikipedia234]</a></td><td><a class="reference external" href="http://en.wikipedia.org/wiki/A*_search_algorithm">http://en.wikipedia.org/wiki/A*_search_algorithm</a></td></tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">g</span> <span class="o">=</span> <span class="n">gt</span><span class="o">.</span><span class="n">load_graph</span><span class="p">(</span><span class="s2">&quot;search_example.xml&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">name</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">vp</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">weight</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="n">ep</span><span class="p">[</span><span class="s2">&quot;weight&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">gt</span><span class="o">.</span><span class="n">astar_iterator</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">vertex</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">weight</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">source</span><span class="p">()],</span> <span class="s2">&quot;-&gt;&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="p">()])</span>
<span class="go">Bob -&gt; Eve</span>
<span class="go">Bob -&gt; Chuck</span>
<span class="go">Bob -&gt; Carlos</span>
<span class="go">Bob -&gt; Isaac</span>
<span class="go">Eve -&gt; Imothep</span>
<span class="go">Eve -&gt; Carol</span>
<span class="go">Carlos -&gt; Alice</span>
<span class="go">Alice -&gt; Oscar</span>
<span class="go">Alice -&gt; Dave</span>
</pre></div>
</div>
</dd></dl>

<dl class="exception">
<dt id="graph_tool.search.StopSearch">
<em class="property">exception </em><code class="descclassname">graph_tool.search.</code><code class="descname">StopSearch</code><a class="reference internal" href="../static/doc/_modules/graph_tool/search.html#StopSearch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="search_module.html#graph_tool.search.StopSearch" title="Permalink to this definition">¶</a></dt>
<dd><p>If this exception is raised from inside any search visitor object, the search is aborted.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../doc">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="search_module.html#"><code class="docutils literal notranslate"><span class="pre">graph_tool.search</span></code> - Search algorithms</a><ul>
<li><a class="reference internal" href="search_module.html#summary">Summary</a></li>
<li><a class="reference internal" href="search_module.html#examples">Examples</a></li>
<li><a class="reference internal" href="search_module.html#contents">Contents</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="community.html"
                        title="previous chapter"><code class="docutils literal notranslate"><span class="pre">graph_tool.inference</span></code> - Statistical inference of generative network models</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="spectral.html"
                        title="next chapter"><code class="docutils literal notranslate"><span class="pre">graph_tool.spectral</span></code> - Spectral properties</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../static/doc/_sources/search_module.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="https://graph-tool.skewed.de/static/doc/search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="https://graph-tool.skewed.de/static/doc/genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="https://graph-tool.skewed.de/static/doc/py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="spectral.html" title="graph_tool.spectral - Spectral properties"
             >next</a> |</li>
        <li class="right" >
          <a href="community.html" title="graph_tool.inference - Statistical inference of generative network models"
             >previous</a> |</li>
    <li><img src="../img/graph-icon.png" alt="logo" style="margin-right: 5px; margin-bottom:-2px;" /><a href="https://graph-tool.skewed.de/">Project Homepage</a> &raquo;</li>
    
        <li class="nav-item nav-item-0"><a href="../doc">graph-tool 2.27 documentation</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../static/doc/modules.html" >Module documentation</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="https://graph-tool.skewed.de/static/doc/graph_tool.html" >graph_tool - efficient graph analysis and manipulation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Tiago de Paula Peixoto &lt;tiago@skewed.de&gt;.
      Last updated on Jun 28, 2018.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.5.
    </div>
  </body>
</html>